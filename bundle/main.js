!function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var r={UP:40,RIGHT:39,DOWN:38,LEFT:37,NONE:-1};const n=document.createElement("img");n.src="src/assets/js.png",n.className="jsImage";var o={async countRound(e,t=10){for(let s=t;s>=0;s--){if(this.cancelled)return;await i(1e3),e(s)}},cancel(){this.cancelled=!0},startCounting(e){return this.cancelled=!1,new Promise(t=>{this.countRound(e=>{this.domEl.innerHTML=`${(e/60).toFixed(0)}:${("0"+e%60).slice(-2)}`,e||t()},e)})},makeItATimer(e){this.domEl=e}};function i(e){return new Promise(t=>setTimeout(t,e))}var c={build(e){const t=new class{constructor(e=[]){this.rows=e,this.npcs=[],this.render(),this.Timer=o}activate(e,t){const s=this.getBlock(e,t);s.activate(),this.activeBlock=s}deactivate(e,t){this.getBlock(e,t).deactivate()}addNPC(e,t){const s=this.getBlock(t.x,t.y);e.goTo(s,!0),this.npcs.push(e)}getNPCsAt(e){const t=this.getBlock(e.x,e.y);return this.npcs.filter(e=>e.actualBlock===t)}captureNPCsAt(e){const t=this.getNPCsAt(e);t.forEach(e=>e.die()),this.npcs.length||this.win();const s=document.getElementById("score-number");s.innerHTML=+s.innerHTML+t.length}win(){this.Timer.cancel(),alert("You won!"),p()}lose(){[...this.npcs].forEach(e=>{e.die()}),alert("You lost!"),p()}move(e=r.RIGHT){let t=this.activeBlock.x,s=this.activeBlock.y,n=t,o=s;switch(e){case r.UP:++o;break;case r.DOWN:--o;break;case r.RIGHT:++n;break;case r.LEFT:--n}o>=this.getHeight()||n>=this.getWidth()||o<0||n<0||"1"===this.getBlock(n,o).status||(this.deactivate(t,s),this.captureNPCsAt({x:n,y:o}),this.activate(n,o))}getBlock(e,t){return this.rows[t].blocks[e]}getHeight(){return this.rows.length}getWidth(){return this.rows[0].blocks.length}render(){const e=this.rows.map(e=>e.render());return this.renderedArea=document.createElement("div"),this.renderedArea.id="area-l",this.renderedArea.className="area",e.forEach(t=>{this.renderedArea.appendChild(t),t.style.height=`${100/e.length}%`}),this.renderedArea}push(e){e.area=this,this.rows.push(e)}};return e.rows.forEach((e,s)=>{const o=new class{constructor(e,t=[]){this.blocks=t,this.rowNumber=e}push(e){e.row=this,this.blocks.push(e)}render(){const e=this.blocks.map(e=>e.render());return this.renderedRow=document.createElement("div"),this.renderedRow.className="row",e.forEach(e=>{this.renderedRow.appendChild(e)}),this.renderedRow}}(s);e.split("").forEach((e,t)=>{const i=new class{constructor(e,t){this.y=e,this.x=t,e||t||(this.isHead=!0)}render(){return this.renderedBlock=document.createElement("div"),this.renderedBlock.classList.add("block"),"1"===this.status&&this.renderedBlock.classList.add("blocked-block"),this.renderedBlock}to(e){if(!this.row.area.rows[this.y+1]||!this.row.area.rows[this.y-1])return;let t;switch(e){case r.DOWN:t=this.row.area.rows[this.y+=1].blocks[this.x];break;case r.LEFT:t=this.row.blocks[this.x-=1];break;case r.RIGHT:t=this.row.blocks[this.x+=1];break;case r.UP:t=this.row.area.rows[this.y-=1].blocks[this.x]}return t}activate(){this.activated=1,this.renderedBlock.classList.add("block-active"),this.renderedBlock.appendChild(n)}deactivate(){this.activated=0,this.renderedBlock.classList.remove("block-active"),n.remove()}setStatus(e){this.status=e}}(s,t);i.setStatus(e),o.push(i)}),t.push(o)}),t}};var a="angular ember jquery meteor mongoose react vue".split(" ").map(e=>"src/assets/frameworks/"+e+".png"),l=e=>{const t=e.x,s=e.y;return[{name:"Right",x:t+1,y:s},{name:"Down",x:t,y:s+1},{name:"Left",x:t-1,y:s},{name:"Up",x:t,y:s-1},{name:"Upright",x:t+1,y:s-1},{name:"Upleft",x:t-1,y:s-1},{name:"Downright",x:t+1,y:s+1},{name:"Downleft",x:t-1,y:s+1}]};class d{constructor(){this.blockFound=!0}randomMove(){const e=Object.keys(moves);e.splice(e.indexOf(moves[moves.NONE]),1);const t=this.randomQuota(e.length);return moves[e[t]]}randomQuota(e){return Math.floor(Math.random()*e,1)}randomBlock(e){const t=e.getWidth(),s=e.getHeight(),r=this.randomQuota(t),n=this.randomQuota(s),o=e.rows[n].blocks[r];return"1"===o.status?this.randomBlock(e):o}touchingBlocks(e){const t=l(e),s=e.row.area;return t.map(e=>{const t=s.rows[e.y];if(!t)return null;const r=t.blocks[e.x];return r&&"1"!==r.status?{name:e.name,block:r}:null}).filter(e=>e)}wayBlocks(e,t){const s=this.touchingBlocks(e),r=[],n=e=>r.push(s.filter(t=>t.name===e)[0]),o=t.x>e.x,i=t.x<e.x,c=t.y>e.y,a=t.y<e.y;return o&&n("Right"),i&&n("Left"),a?n("Up"):c&&n("Down"),a&&i?n("Upleft"):a&&o?n("Upright"):c&&i?n("Downleft"):c&&o&&n("DownRight"),r}findNextBlock(e,t){const s=this.wayBlocks(e,t);return s[this.randomQuota(s.length)]}guideMe(e,t){const s=e.row.area;if(this.blockFound)return this.destinationBlock=this.randomBlock(s),void(this.blockFound=!1);const r=this.findNextBlock(e,this.destinationBlock);if(r)return r.block===this.destinationBlock&&(this.blockFound=!0),r;this.destinationBlock=this.randomBlock(s)}}class h{constructor(){const e=a[Math.floor(Math.random()*a.length,1)];this.element=document.createElement("img"),this.element.src=e,this.element.className="jsImage",this.oracle=new d,a.splice(a.indexOf(e),1)}goTo(e){this.removeElement();let t=e.renderedBlock.addEventListener("loaded",()=>{this.actualBlock=e,e.removeEventListener(t)});e.renderedBlock.appendChild(this.element),e.activated&&(e.renderedBlock.classList.add("dribbled"),setTimeout(()=>e.renderedBlock.classList.remove("dribbled"),500)),this.actualBlock=e}startToWalk(){this.interval=setInterval(()=>{const e=this.oracle.guideMe(this.actualBlock,this.element.src);if(!e)return;const t=e.block;return t?this.goTo(t):void 0},100)}removeElement(){this.element.parentElement&&this.element.remove()}die(){console.log("dying"),clearInterval(this.interval),a.push(this.element.src),this.actualBlock.renderedBlock.classList.add("eating"),setTimeout(()=>this.actualBlock.renderedBlock.classList.remove("eating"),500);const e=this.actualBlock.row.area.npcs;let t=e.indexOf(this);-1!==t&&(e.splice(t,1),this.removeElement())}}const u=a.length;var m={injectOn(e){let t=0;for(let s=0;s<e.getHeight()&&!(t>=u);s+=2){const r=new h;e.addNPC(r,{x:s,y:0}),t++}}},k={rows:["00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000111","00000000001010000000","00000000001010000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000001110111000000","00111101001001000000","00000000100010000000","00111000011000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000"]},g=function(e,t){let s=0;return function(...r){const n=(new Date).getTime();if(!(n-s<t))return s=n,e(...r)}};s.d(t,"setupArea",function(){return p});function p(){const e=c.build(k),t=document.getElementById("area-l");t&&t.remove(),document.querySelector("#game").appendChild(e.render()),e.activate(10,10),m.injectOn(e),document.addEventListener("keydown",g(t=>{const s=t.keyCode,n=Object.values(r).filter(e=>e===s)[0];n&&e.move(n)},50));const s=document.getElementById("btn-go"),n=document.getElementById("ready-tile");n.style.display="block",s.addEventListener("click",()=>{e.npcs.forEach(e=>e.startToWalk()),n.style.display="none",e.Timer.makeItATimer(document.getElementById("timer-number")),e.Timer.startCounting(120).then(()=>e.lose())})}p()}]);