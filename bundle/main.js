!function(e){var t={};function s(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=0)}([function(e,t,s){"use strict";s.r(t);var r={UP:40,RIGHT:39,DOWN:38,LEFT:37,NONE:-1};const o=document.createElement("img");o.src="src/assets/js.png",o.className="jsImage";var n={build(e){const t=new class{constructor(e=[]){this.rows=e,this.npcs=[],this.render()}activate(e,t){const s=this.getBlock(e,t);s.activate(),this.activeBlock=s}deactivate(e,t){this.getBlock(e,t).deactivate()}addNPC(e,t){const s=this.getBlock(t.x,t.y);e.goTo(s,!0),this.npcs.push(e)}getNPCsAt(e){const t=this.getBlock(e.x,e.y);return this.npcs.filter(e=>e.actualBlock===t)}captureNPCsAt(e){this.getNPCsAt(e).forEach(e=>e.die()),this.npcs.length||this.win()}win(){alert("You won!")}move(e=r.RIGHT){let t=this.activeBlock.x,s=this.activeBlock.y,o=t,n=s;switch(e){case r.UP:++n;break;case r.DOWN:--n;break;case r.RIGHT:++o;break;case r.LEFT:--o}n>=this.getHeight()||o>=this.getWidth()||n<0||o<0||"1"===this.getBlock(o,n).status||(this.deactivate(t,s),this.captureNPCsAt({x:o,y:n}),this.activate(o,n))}getBlock(e,t){return this.rows[t].blocks[e]}getHeight(){return this.rows.length}getWidth(){return this.rows[0].blocks.length}render(){const e=this.rows.map(e=>e.render());return this.renderedArea=document.createElement("div"),this.renderedArea.className="area",e.forEach(t=>{this.renderedArea.appendChild(t),t.style.height=`${100/e.length}%`}),this.renderedArea}push(e){e.area=this,this.rows.push(e)}};return e.rows.forEach((e,s)=>{const n=new class{constructor(e,t=[]){this.blocks=t,this.rowNumber=e}push(e){e.row=this,this.blocks.push(e)}render(){const e=this.blocks.map(e=>e.render());return this.renderedRow=document.createElement("div"),this.renderedRow.className="row",e.forEach(e=>{this.renderedRow.appendChild(e)}),this.renderedRow}}(s);e.split("").forEach((e,t)=>{const i=new class{constructor(e,t){this.y=e,this.x=t,e||t||(this.isHead=!0)}render(){return this.renderedBlock=document.createElement("div"),this.renderedBlock.classList.add("block"),"1"===this.status&&this.renderedBlock.classList.add("blocked-block"),this.renderedBlock}to(e){if(!this.row.area.rows[this.y+1]||!this.row.area.rows[this.y-1])return;let t;switch(e){case r.DOWN:t=this.row.area.rows[this.y+=1].blocks[this.x];break;case r.LEFT:t=this.row.blocks[this.x-=1];break;case r.RIGHT:t=this.row.blocks[this.x+=1];break;case r.UP:t=this.row.area.rows[this.y-=1].blocks[this.x]}return t}activate(){this.activated=1,this.renderedBlock.classList.add("block-active"),this.renderedBlock.appendChild(o)}deactivate(){this.activated=0,this.renderedBlock.classList.remove("block-active"),o.remove()}setStatus(e){this.status=e}}(s,t);i.setStatus(e),n.push(i)}),t.push(n)}),t}};var i="angular ember jquery meteor mongoose react vue".split(" ").map(e=>"src/assets/frameworks/"+e+".png"),c=e=>{const t=e.x,s=e.y;return[{name:"Right",x:t+1,y:s},{name:"Down",x:t,y:s+1},{name:"Left",x:t-1,y:s},{name:"Up",x:t,y:s-1},{name:"Upright",x:t+1,y:s-1},{name:"Upleft",x:t-1,y:s-1},{name:"Downright",x:t+1,y:s+1},{name:"Downleft",x:t-1,y:s+1}]};class a{constructor(){this.blockFound=!0}randomMove(){const e=Object.keys(moves);e.splice(e.indexOf(moves[moves.NONE]),1);const t=this.randomQuota(e.length);return moves[e[t]]}randomQuota(e){return Math.floor(Math.random()*e,1)}randomBlock(e){const t=e.getWidth(),s=e.getHeight(),r=this.randomQuota(t),o=this.randomQuota(s),n=e.rows[o].blocks[r];return"1"===n.status?this.randomBlock(e):n}touchingBlocks(e){const t=c(e),s=e.row.area;return t.map(e=>{const t=s.rows[e.y];if(!t)return null;const r=t.blocks[e.x];return r&&"1"!==r.status?{name:e.name,block:r}:null}).filter(e=>e)}wayBlocks(e,t){const s=this.touchingBlocks(e),r=[],o=e=>r.push(s.filter(t=>t.name===e)[0]),n=t.x>e.x,i=t.x<e.x,c=t.y>e.y,a=t.y<e.y;return n&&o("Right"),i&&o("Left"),a?o("Up"):c&&o("Down"),a&&i?o("Upleft"):a&&n?o("Upright"):c&&i?o("Downleft"):c&&n&&o("DownRight"),r}findNextBlock(e,t){const s=this.wayBlocks(e,t);return s[this.randomQuota(s.length)]}guideMe(e,t){const s=e.row.area;if(this.blockFound)return this.destinationBlock=this.randomBlock(s),void(this.blockFound=!1);const r=this.findNextBlock(e,this.destinationBlock);if(r)return r.block===this.destinationBlock&&(this.blockFound=!0),r;this.destinationBlock=this.randomBlock(s)}}class l{constructor(){const e=i[Math.floor(Math.random()*i.length,1)];this.element=document.createElement("img"),this.element.src=e,this.element.className="jsImage",this.oracle=new a,i.splice(i.indexOf(e),1)}goTo(e){this.removeElement();let t=e.renderedBlock.addEventListener("loaded",()=>{this.actualBlock=e,e.removeEventListener(t)});e.renderedBlock.appendChild(this.element),e.activated&&(e.renderedBlock.classList.add("dribbled"),setTimeout(()=>e.renderedBlock.classList.remove("dribbled"),500)),this.actualBlock=e}startToWalk(){this.interval=setInterval(()=>{const e=this.oracle.guideMe(this.actualBlock,this.element.src);if(!e)return;const t=e.block;return t?this.goTo(t):void 0},100)}removeElement(){this.element.parentElement&&this.element.remove()}die(){clearInterval(this.interval),i.push(this.element.src),this.actualBlock.renderedBlock.classList.add("eating"),setTimeout(()=>this.actualBlock.renderedBlock.classList.remove("eating"),500);const e=this.actualBlock.row.area.npcs;let t=e.indexOf(this);-1!==t&&(e.splice(t,1),this.removeElement())}}const h=i.length;var d={injectOn(e){let t=0;for(let s=0;s<e.getHeight()&&!(t>=h);s+=2){const r=new l;e.addNPC(r,{x:s,y:0}),t++}}},u={rows:["00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000111","00000000001010000000","00000000001010000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00111100000000000000","00000000000000000000","00111000000000000000","00000000000000000000","00000000000000000000","00000000000000000000","00000000000000000000"]},m=function(e,t){let s=0;return function(...r){const o=(new Date).getTime();if(!(o-s<t))return s=o,e(...r)}};!function(){const e=n.build(u);document.querySelector("#game").appendChild(e.render()),e.activate(10,10),d.injectOn(e),document.addEventListener("keydown",m(t=>{const s=t.keyCode,o=Object.values(r).filter(e=>e===s)[0];o&&e.move(o)},70));const t=document.getElementById("btn-go"),s=document.getElementById("ready-tile");t.addEventListener("click",()=>{e.npcs.forEach(e=>e.startToWalk()),s.style.display="none"})}()}]);